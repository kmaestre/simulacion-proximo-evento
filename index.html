<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Proyecto #2 | Simulación y Modelos</title>
  <link rel="stylesheet" href="vendor/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="vendor/alertify.min.css">
  <link rel="stylesheet" type="text/css" href="vendor/alertify.bootstrap.min.css">
  <style>
    * {
      font-family: 'Fira Code'
    }

    .full {
      width: 100vw;
      height: 100vh;
    }

    #conditionWrapper {
      display: none
    }
  </style>

</head>

<body class="container-fluid">
  <div class="row" style="display: hidden">
  </div>

  <div class="full row d-flex justify-content-center align-items-center">
    <div id="form">
      <h4 class="text-center">Parametros Iniciales:</h4>
      <br>
      <div class="form-group">
        <label for="">Condicion de Parada</label>
        <select class="form-control" id="stop" onchange="setInput()">
          <option value="">Seleccionar</option>
          <option value="1">Nº de Solicitudes</option>
          <option value="2">Nº de Finalizados</option>
          <option value="3">Tiempo de simulacion</option>
        </select>
      </div>
      <div class="form-group" id="conditionWrapper">
        <label for="" id="stopLabel"></label>
        <input class="form-control" id="stopValue" name="input" onkeydown="removeBorders()" oninput="soloNumeros()">
      </div>
      <div class="form-group">
        <button class="btn btn-dark btn-block btn-sm" onclick="runSimulation()">Iniciar</button>
      </div>
    </div>
  </div>

  <script src="vendor/jquery-slim.min.js"></script>
  <script src="vendor/popper.min.js"></script>
  <script src="vendor/bootstrap.min.js"></script>
  <script src="vendor/alertify.js"></script>


  <script>
    $('#dataInput').modal()

    $(function () {
      $('#content-tab').on('click', function (e) {
        e.preventDefault()
        $(this).tab('show')
      })
    })

    const soloNumeros = () => {
      event.target.value = event.target.value.replace(/\D/gi, '')
    }

    const removeBorders = () => {
      event.target.style = ''
    }

    const setInput = () => {
      let val = event.target.value
      if (val == '') {
        $('#conditionWrapper').css('display', 'none')
        return
      }
      if ('1' === val || '2' === val) {
        $('#stopLabel').text('Cantidad');
      }
      if ('3' === val) {
        $('#stopLabel').text('Tiempo(seg)')
      }
      
      $('#conditionWrapper').css('display', 'inherit')
    }

    const runSimulation = () => {
      let stopOption = document.getElementById('stop').value
      let stopValue = document.getElementById('stopValue').value

      if (stopOption == '1' && stopValue != '') {
        // preparar condicion de parada para este caso
      } else if (stopOption == '2' && stopValue != '') {
        // preparar condicion de parada para este caso
      } else if (stopOption == '3' && stopValue != '') {
        // preparar condicion de parada para este caso
      } else {
        if (!stopValue) {
          alertify.alert('Error', 'Debe indicar un valor valido para la condicion de parada')
          document.getElementById('stopValue').style = 'border: 1px solid red; color: red;'
          return
        }
        alertify.alert('Info', 'La simulacion se detendra al llegar a los ' + parseInt(stopValue) + ' segundos')
      }

      setFirstArrivalQuestion()
      //setFirstDepartureQuestion()

    }
    const setFirstDepartureQuestion = () => {
      let html = `
        <div class="modal-body text-center">
          <p>¿Desea indicar el tiempo de la primera finalizacion de servicio?</p>
          <div class="row">
            <div class="form-group col-5 mx-auto">
              <button class="btn btn-danger btn-block" onclick="fDeparture = null">No</button>
            </div>
            <div class="form-group col-5 mx-auto">
              <button class="btn btn-dark btn-block" onclick="setFirstDeparture()">Si</button>
            </div>
          </div>
        </div>
      `

      $('#form').html(html)

    }

    const setFirstArrivalQuestion = () => {
      let html = `
        <div class="modal-body text-center">
          <p>¿Desea indicar el tiempo de la primera solicitud de servicio?</p>
          <div class="row">
            <div class="form-group col-5 mx-auto">
              <button class="btn btn-danger btn-block" onclick="fArrival = null;setFirstDepartureQuestion()">No</button>
            </div>
            <div class="form-group col-5 mx-auto">
              <button class="btn btn-dark btn-block" onclick="setFirstArrival()">Si</button>
            </div>
          </div>
        </div>
      `

      $('#form').html(html)

    }

    const setFirstArrival = () => {
      let html = `
        <div class="modal-body text-center">
          <div class="form-group col-12 mx-auto">
            <label>Tiempo (seg)</label>
            <input type="text" class="form-control input-sm" id="firstReq" oninput="soloNumeros()">
          </div>
          <div class="form-group col-5 mx-auto">
            <button class="btn btn-dark btn-block" onclick="fArrival = parseInt($('#firstReq').val()); setFirstDepartureQuestion()">Aceptar</button>
          </div>
        </div>
      `
      
      $('#form').html(html)
    }
    const setFirstDeparture = () => {
      let html = `
        <div class="modal-body text-center">
          <div class="form-group col-12 mx-auto">
            <label>Tiempo (seg)</label>
            <input type="text" class="form-control input-sm" id="firstDep" oninput="soloNumeros()">
          </div>
          <div class="form-group col-5 mx-auto">
            <button class="btn btn-dark btn-block" onclick="fDesetFirstDeparture = parseInt($('#firstDep').val()); setFirstDepartureQuestion()">Aceptar</button>
          </div>
        </div>
      `
      
      $('#form').html(html)
    }

    /*
      `*/
  </script>
</body>

</html>